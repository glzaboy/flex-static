"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t(require("jquery")):t("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(t){var o={escapeurl:function(t){var o={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return t.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(t,a){return o[a]})},geturlparam:function(t){var o=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),a=location.search.substr(1).match(o);return null!=a?decodeURIComponent(a[2]):null},geturlparams:function(){for(var t={},o=null,a=decodeURIComponent(location.search.substring(1)),e=/(?:([^&]+)=([^&]+))/g;null!==(o=e.exec(a));)t[o[1]]=o[2];return t}};t.extend({escapeurl:o.escapeurl,geturlparam:o.geturlparam,geturlparams:o.geturlparams,replaceurlparams:function(a,e){var e=e||window.location.href.replace(/\?.{0,}/,""),n=window.location.search?window.location.search:"";t.each(a,function(t,a){console.log(t),console.log(a);var e=new RegExp("(^|&)"+t+"=[^&]*","i");n=o.geturlparam(t)?"?"+n.substr(1).replace(e,RegExp.$1+t+"="+a):n.match(/^\?/)&&n.length>1?n+"&"+t+"="+encodeURIComponent(a):"?"+t+"="+encodeURIComponent(a)}),window.location.href=e+n}}),t.extend({replaceurlparam:function(o,a,e){t.replaceurlparams(JSON.parse('{"'+o+'": "'+a+'"}'),e)}}),t.fn.extend({formErrorReset:function(){return t(this).each(function(o,a){var e=t(this).hasClass("form-inline");t(this).find(".alert").remove(),t(this).find(".form-group,.checkbox,.radio").each(function(o,a){e?(t(this).removeClass("has-error").find("input,textarea,select").each(function(){t(this).tooltip("destroy")}),t(this).tooltip("destroy")):t(this).hasClass("has-error")&&t(this).find(".help-block").data("orgtext")?t(this).removeClass("has-error").find(".help-block").html(t(this).find(".help-block").data("orgtext")):t(this).hasClass("has-error")&&t(this).removeClass("has-error").find(".help-block").remove()})}),t(this)},formFiledError:function(o){var a=t(this).parents(".form-group,.checkbox,.radio"),e="checkbox"==t(this).attr("type")||"radio"==t(this).attr("type"),n=t(this).parents("form").hasClass("form-inline");a.length?(a.addClass("has-error"),e&&!a.hasClass("checkbox")&&a.addClass("checkbox"),a.find(".help-block").length?(html=a.find(".help-block").html(),a.find(".help-block").data("orgtext",html).html(o)):n?window.setTimeout(function(){a.tooltip({container:"body",html:!0,placement:"top",title:o})},500):t(this).parent().append('<small class="help-block">'+o+"</small>")):t(this).parent("form").prepend('<div class="alert alert-danger"><button class="close" data-dismiss="alert"><i class="pci-cross pci-circle"></i></button>'+obj+"</div>")}}),t("body").on("req.ajax",".ajax",function(o){var a=t(this),e=a.attr("title");e||(e=a.text());var n=t(this).attr("href");if(console.log("url"+n),a.data("ajaxing"))return t.niftyNoty({type:"danger",message:"程序已经提交中了，请稍后片刻。",container:"floating",timer:5e3}),!1;a.data("ajaxing",!0),t.ajax({type:"GET",url:n,dataType:"json",data:{form:".ajax"}}).done(function(o){console.log(o),o.linkTextChange&&a.text(o.linkTextChange),o.autoJump&&window.setTimeout(function(){window.location.href=o.link?t.escapeurl(o.link):window.location.href},1e3*o.autoJump),o.autoHide&&("string"==typeof o.autoHide&&a.parents(o.autoHide).length?a.parents(o.autoHide).hide(1e3,function(){t(this).remove()}):a.hide(1e3,function(){t(this).remove()})),o.message&&($dialogoption={},$dialogoption.message=o.message,$dialogoption.title="提示信息",$dialogoption.buttons={},o.link&&o.link.length>0?$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){window.location.href=o.link}}:$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){}},t.dialog("remove"),t.dialog($dialogoption))}).fail(function(o,a){t.niftyNoty({type:"danger",message:a,container:"floating",timer:5e3})}).always(function(t){a.data("ajaxing",!1)})}),t("body").on("click",".ajaxask,.ajax",function(o){o.preventDefault();var a=t(this);if(a.hasClass("ajax")||a.addClass("ajax"),a.hasClass("ajaxask")){var e=a.data("asktext")?a.data("asktext"):"您确定要"+a.text()+"?";return $dialogoption={},$dialogoption.message=e,$dialogoption.title="提示信息",$dialogoption.buttons={},$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){a.trigger("req.ajax")}},$dialogoption.buttons.cancel={label:"取消",className:"btn",callback:function(){}},t.dialog("remove"),t.dialog($dialogoption)}t(this).trigger("req.ajax")}),t("body").on("click",".ajaxdialog",function(o){o.preventDefault();var a=t(this),e=a.attr("title");e||(e=a.text());var n=a.attr("href");return $dialogoption={},$dialogoption.url=n,$dialogoption.title=e,$dialogoption.buttons={},$dialogoption.buttons.ok={label:"提交",className:"btn-primary",callback:function(o){var a=t(".jquerydialog").find("form");return a.length&&a.trigger("submit"),!1}},$dialogoption.buttons.cancel={label:"取消",className:"btn",callback:function(){}},t.dialog($dialogoption)}),t("body").on("submit","form.ajaxform",function(o){o.preventDefault();var a=t(this);if(a.data("submiting"))return t.niftyNoty({type:"danger",message:"程序已经提交中了，请稍后片刻。",container:"floating",timer:5e3}),!1;a.data("submiting",1);var e={};if(e.url=a.attr("action")?a.attr("action"):window.location.href,e.type=a.attr("method")?a.attr("method"):"GET",e.data=a.serializeArray(),e.dataType="json","GET"==e.type.toUpperCase()){var n=t.param(e.data);e.url+=(e.url.indexOf("?")>=0?"&":"?")+n,e.data=null}a.formErrorReset(),t.ajax(e).done(function(o,e){console.log(o),o.message&&($dialogoption={},$dialogoption.message=o.message,$dialogoption.title="提示信息",$dialogoption.buttons={},o.link&&o.link.length>0?$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){window.location.href=o.link}}:$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){}},t.dialog("remove"),t.dialog($dialogoption)),o.autoJump&&window.setTimeout(function(){window.location.href=o.link?t.escapeurl(o.link):window.location.href},1e3*o.autoJump),o.error&&t.each(o.error,function(t,o){var e=a.find("input[name='"+t+"'],textarea[name='"+t+"'],select[name='"+t+"']"),n=e.parents(".form-group,.checkbox,.radio");e.length&&n.length?e.formFiledError(o):a.prepend('<div class="alert alert-danger"><button class="close" data-dismiss="alert"><i class="pci-cross pci-circle"></i></button>'+o+"</div>")})}).fail(function(o,a){t.niftyNoty({type:"danger",message:"提交数据出错，可能是服务器正在维护或是网络问题，请稍后再试。",container:"floating",timer:5e3})}).always(function(){a.data("submiting",0),console.log("complete")})})});
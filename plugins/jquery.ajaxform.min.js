!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(a){var b={escapeurl:function(a){var b={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return a.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(a,c){return b[c]})},geturlparam:function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),c=location.search.substr(1).match(b);return null!=c?decodeURIComponent(c[2]):null},geturlparams:function(){for(var a={},b=null,c=decodeURIComponent(location.search.substring(1)),d=/(?:([^&]+)=([^&]+))/g;null!==(b=d.exec(c));)a[b[1]]=b[2];return a}};a.extend({escapeurl:b.escapeurl,geturlparam:b.geturlparam,geturlparams:b.geturlparams,replaceurlparams:function(c,d){var e;d=d?d:window.location.href.replace(/\?.{0,}/,""),e=window.location.search?window.location.search:"",a.each(c,function(a,c){console.log(a),console.log(c);var d=new RegExp("(^|&)"+a+"=[^&]*","i");e=b.geturlparam(a)?"?"+e.substr(1).replace(d,RegExp.$1+a+"="+c):e.match(/^\?/)&&e.length>1?e+"&"+a+"="+encodeURIComponent(c):"?"+a+"="+encodeURIComponent(c)}),window.location.href=d+e}}),a.extend({replaceurlparam:function(b,c,d){a.replaceurlparams(JSON.parse('{"'+b+'": "'+c+'"}'),d)}}),a.fn.extend({formErrorReset:function(){return a(this).each(function(){var d=a(this).hasClass("form-inline");a(this).find(".alert").remove(),a(this).find(".form-group,.checkbox,.radio").each(function(){d?(a(this).removeClass("has-error").find("input,textarea,select").each(function(){a(this).tooltip("destroy")}),a(this).tooltip("destroy")):a(this).hasClass("has-error")&&a(this).find(".help-block").data("orgtext")?a(this).removeClass("has-error").find(".help-block").html(a(this).find(".help-block").data("orgtext")):a(this).hasClass("has-error")&&a(this).removeClass("has-error").find(".help-block").remove()})}),a(this)},formFiledError:function(b){var c=a(this).parents(".form-group,.checkbox,.radio"),d="checkbox"==a(this).attr("type")||"radio"==a(this).attr("type"),e=a(this).parents("form").hasClass("form-inline");c.length?(c.addClass("has-error"),d&&!c.hasClass("checkbox")&&c.addClass("checkbox"),c.find(".help-block").length?(html=c.find(".help-block").html(),c.find(".help-block").data("orgtext",html).html(b)):e?window.setTimeout(function(){c.tooltip({container:"body",html:!0,placement:"top",title:b})},500):a(this).parent().append('<small class="help-block">'+b+"</small>")):a(this).parent("form").prepend('<div class="alert alert-danger"><button class="close" data-dismiss="alert"><i class="pci-cross pci-circle"></i></button>'+obj+"</div>")}}),a("body").on("req.ajax",".ajax",function(){var e,c=a(this),d=c.attr("title");return d||(d=c.text()),e=a(this).attr("href"),console.log("url"+e),c.data("ajaxing")?(a.niftyNoty({type:"danger",message:"程序已经提交中了，请稍后片刻。",container:"floating",timer:5e3}),!1):(c.data("ajaxing",!0),a.ajax({type:"GET",url:e,dataType:"json",data:{form:".ajax"}}).done(function(b){console.log(b),b.linkTextChange&&c.text(b.linkTextChange),b.linkTextChange&&c.text(b.linkTextChange),b.autoJump&&b.link&&b.link.length>0&&window.setTimeout(function(){window.location.href=b.link},1e3*b.autoJump),b.autoHide&&("string"==typeof b.autoHide&&c.parents(b.autoHide).length?c.parents(b.autoHide).hide(1e3,function(){a(this).remove()}):c.hide(1e3,function(){a(this).remove()})),b.message&&($dialogoption={},$dialogoption.message=b.message,$dialogoption.title="提示信息",$dialogoption.buttons={},$dialogoption.buttons.ok=b.link&&b.link.length>0?{label:"确定",className:"btn-primary",callback:function(){window.location.href=b.link}}:{label:"确定",className:"btn-primary",callback:function(){}},a.dialog($dialogoption))}).fail(function(b,c){a.niftyNoty({type:"danger",message:c,container:"floating",timer:5e3})}).always(function(){c.data("ajaxing",!1)}),void 0)}),a("body").on("click",".ajaxask,.ajax",function(b){var c,d;return b.preventDefault(),c=a(this),c.hasClass("ajax")||c.addClass("ajax"),c.hasClass("ajaxask")?(d=c.data("asktext")?c.data("asktext"):"您确定要"+c.text()+"?",$dialogoption={},$dialogoption.message=d,$dialogoption.title="提示信息",$dialogoption.buttons={},$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){c.trigger("req.ajax")}},$dialogoption.buttons.cancel={label:"取消",className:"btn",callback:function(){}},a.dialog($dialogoption)):(a(this).trigger("req.ajax"),void 0)}),a("body").on("click",".ajaxdialog",function(b){var c,d,e;return b.preventDefault(),c=a(this),d=c.attr("title"),d||(d=c.text()),e=c.attr("href"),$dialogoption={},$dialogoption.url=e,$dialogoption.title=d,$dialogoption.buttons={},$dialogoption.buttons.ok={label:"提交",className:"btn-primary",callback:function(){var c=a(".jquerydialog").find("form");return c.length&&c.trigger("submit"),!1}},$dialogoption.buttons.cancel={label:"取消",className:"btn",callback:function(){}},a.dialog($dialogoption)}),a("body").on("submit","form.ajaxform",function(b){var c,d,e;return b.preventDefault(),c=a(this),c.data("submiting")?(a.niftyNoty({type:"danger",message:"程序已经提交中了，请稍后片刻。",container:"floating",timer:5e3}),!1):(c.data("submiting",1),d={},d.url=c.attr("action")?c.attr("action"):window.location.href,d.type=c.attr("method")?c.attr("method"):"GET",d.data=c.serializeArray(),d.dataType="json","GET"==d.type.toUpperCase()&&(e=a.param(d.data),d.url+=(d.url.indexOf("?")>=0?"&":"?")+e,d.data=null),c.formErrorReset(),a.ajax(d).done(function(b){console.log(b),b.message&&($dialogoption={},$dialogoption.message=b.message,$dialogoption.title="提示信息",$dialogoption.buttons={},$dialogoption.buttons.ok=b.link&&b.link.length>0?{label:"确定",className:"btn-primary",callback:function(){window.location.href=b.link}}:{label:"确定",className:"btn-primary",callback:function(){}},a.dialog($dialogoption)),b.autoJump&&b.link&&b.link.length>0&&window.setTimeout(function(){window.location.href=a.escapeurl(b.link)},1e3*b.autoJump),b.error&&a.each(b.error,function(a,b){var d=c.find("input[name='"+a+"'],textarea[name='"+a+"'],select[name='"+a+"']"),e=d.parents(".form-group,.checkbox,.radio");d.length&&e.length?d.formFiledError(b):c.prepend('<div class="alert alert-danger"><button class="close" data-dismiss="alert"><i class="pci-cross pci-circle"></i></button>'+b+"</div>")})}).fail(function(){a.niftyNoty({type:"danger",message:"提交数据出错，可能是服务器正在维护或是网络问题，请稍后再试。",container:"floating",timer:5e3})}).always(function(){c.data("submiting",0),console.log("complete")}),void 0)})});
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t(require("jquery")):t("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(t){var a={escapeurl:function(t){var a={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return t.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(t,e){return a[e]})},geturlparam:function(t){var a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),e=location.search.substr(1).match(a);return null!=e?decodeURIComponent(e[2]):null},geturlparams:function(){for(var t={},a=null,e=decodeURIComponent(location.search.substring(1)),o=/(?:([^&]+)=([^&]+))/g;null!==(a=o.exec(e));)t[a[1]]=a[2];return t}};t.extend({escapeurl:a.escapeurl,geturlparam:a.geturlparam,geturlparams:a.geturlparams,replaceurlparams:function(e,o){var o=o||window.location.href.replace(/\?.{0,}/,""),n=window.location.search?window.location.search:"";t.each(e,function(t,e){console.log(t),console.log(e);var o=new RegExp("(^|&)"+t+"=[^&]*","i");n=a.geturlparam(t)?"?"+n.substr(1).replace(o,RegExp.$1+t+"="+e):n.match(/^\?/)&&n.length>1?n+"&"+t+"="+encodeURIComponent(e):"?"+t+"="+encodeURIComponent(e)}),window.location.href=o+n}}),t.extend({replaceurlparam:function(a,e,o){t.replaceurlparams(JSON.parse('{"'+a+'": "'+e+'"}'),o)}}),t.fn.extend({formErrorReset:function(){return t(this).each(function(a,e){var o=t(this).hasClass("form-inline");t(this).find(".alert").remove(),t(this).find(".form-group,.checkbox,.radio").each(function(a,e){o?(t(this).removeClass("has-error").find("input,textarea,select").each(function(){t(this).tooltip("destroy")}),t(this).tooltip("destroy")):t(this).hasClass("has-error")&&t(this).find(".help-block").data("orgtext")?t(this).removeClass("has-error").find(".help-block").html(t(this).find(".help-block").data("orgtext")):t(this).hasClass("has-error")&&t(this).removeClass("has-error").find(".help-block").remove()})}),t(this)},formFiledError:function(a){var e=t(this).parents(".form-group,.checkbox,.radio"),o="checkbox"==t(this).attr("type")||"radio"==t(this).attr("type"),n=t(this).parents("form").hasClass("form-inline");e.length?(e.addClass("has-error"),o&&!e.hasClass("checkbox")&&e.addClass("checkbox"),e.find(".help-block").length?(html=e.find(".help-block").html(),e.find(".help-block").data("orgtext",html).html(a)):n?window.setTimeout(function(){e.tooltip({container:"body",html:!0,placement:"top",title:a})},500):t(this).parent().append('<small class="help-block">'+a+"</small>")):t(this).parent("form").prepend('<div class="alert alert-danger"><button class="close" data-dismiss="alert"><i class="pci-cross pci-circle"></i></button>'+obj+"</div>")}}),t("body").on("req.ajax",".ajax",function(a){var e=t(this),o=e.attr("title");o||(o=e.text());var n=t(this).attr("href");if(console.log("url"+n),e.data("ajaxing"))return t.niftyNoty({type:"danger",message:"程序已经提交中了，请稍后片刻。",container:"floating",timer:5e3}),!1;e.data("ajaxing",!0),t.ajax({type:"GET",url:n,dataType:"json",data:{form:".ajax"}}).done(function(a){console.log(a),a.linkTextChange&&e.text(a.linkTextChange),a.autoJump&&window.setTimeout(function(){window.location.href=a.link?t.escapeurl(a.link):window.location.href},1e3*a.autoJump),a.autoHide&&("string"==typeof a.autoHide&&e.parents(a.autoHide).length?e.parents(a.autoHide).hide(1e3,function(){t(this).remove()}):e.hide(1e3,function(){t(this).remove()})),a.message&&($dialogoption={},$dialogoption.message=a.message,$dialogoption.title="提示信息",$dialogoption.buttons={},a.link&&a.link.length>0?$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){window.location.href=a.link}}:$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){}},t.dialog("remove"),t.dialog($dialogoption))}).fail(function(a,e){t.niftyNoty({type:"danger",message:e,container:"floating",timer:5e3})}).always(function(t){e.data("ajaxing",!1)})}),t("body").on("click",".ajaxask,.ajax",function(a){a.preventDefault();var e=t(this);if(e.hasClass("ajax")||e.addClass("ajax"),e.hasClass("ajaxask")){var o=e.data("asktext")?e.data("asktext"):"您确定要"+e.text()+"?";return $dialogoption={},$dialogoption.message=o,$dialogoption.title="提示信息",$dialogoption.buttons={},$dialogoption.buttons.ok={label:"确定",className:"btn-primary",callback:function(){e.trigger("req.ajax")}},$dialogoption.buttons.cancel={label:"取消",className:"btn",callback:function(){}},t.dialog("remove"),t.dialog($dialogoption)}t(this).trigger("req.ajax")}),t("body").on("click",".ajaxdialog",function(a){a.preventDefault();var e=t(this),o=e.attr("title");o||(o=e.text());var n=e.attr("href");return $dialogoption={},$dialogoption.url=n,$dialogoption.title=o,$dialogoption.buttons={},$dialogoption.buttons.ok={label:"提交",className:"btn-primary",callback:function(a){var e=t(".jquerydialog").find("form");return e.length&&e.trigger("submit"),!1}},$dialogoption.buttons.cancel={label:"取消",className:"btn",callback:function(){}},t.dialog($dialogoption)}),t("body").on("submit","form.ajaxform",function(a){a.preventDefault();var e=t(this);if(e.data("submiting"))return t.niftyNoty({type:"danger",message:"程序已经提交中了，请稍后片刻。",container:"floating",timer:5e3}),!1;e.data("submiting",1);var o={};if(o.url=e.attr("action")?e.attr("action"):window.location.href,o.type=e.attr("method")?e.attr("method"):"GET",o.data=e.serializeArray(),o.dataType="json","GET"==o.type.toUpperCase()){var n=t.param(o.data);o.url+=(o.url.indexOf("?")>=0?"&":"?")+n,o.data=null}e.formErrorReset(),t.ajax(o).done(function(a,o){if(console.log(a),a.message){var n={};n.message=a.message,n.title="提示信息",n.buttons={},a.link&&a.link.length>0?n.buttons.ok={label:"确定",className:"btn-primary",callback:function(){window.location.href=a.link}}:n.buttons.ok={label:"确定",className:"btn-primary",callback:function(){}},t.dialog("remove"),t.dialog(n)}a.autoJump&&window.setTimeout(function(){window.location.href=a.link?t.escapeurl(a.link):window.location.href},1e3*a.autoJump),a.error&&t.each(a.error,function(t,a){var o=e.find("input[name='"+t+"'],textarea[name='"+t+"'],select[name='"+t+"']"),n=o.parents(".form-group,.checkbox,.radio");o.length&&n.length?o.formFiledError(a):e.prepend('<div class="alert alert-danger"><button class="close" data-dismiss="alert"><i class="pci-cross pci-circle"></i></button>'+a+"</div>")})}).fail(function(a,e){t.niftyNoty({type:"danger",message:"提交数据出错，可能是服务器正在维护或是网络问题，请稍后再试。",container:"floating",timer:5e3})}).always(function(){e.data("submiting",0),console.log("complete")})})});
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?module.exports=b(require("jquery")):b("undefined"!=typeof jQuery?jQuery:window.Zepto)})(function(b){b.extend({escapeurl:function(a){var c={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return a.replace(/&(lt|gt|nbsp|amp|quot);/ig,function(a,b){return c[b]})},geturlparam:function(a){a=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i");a=location.search.substr(1).match(a);return null!=a?decodeURIComponent(a[2]):null},
    geturlparams:function(){for(var a={},c,b=decodeURIComponent(location.search.substring(1)),e=/(?:([^&]+)=([^&]+))/g;null!==(c=e.exec(b));)a[c[1]]=c[2];return a},replaceurlparam:function(a,c,b){var d=new RegExp("(^|&)"+a+"=[^&]*","i");void 0==b?geturlparam(a)?window.location.search="?"+window.location.search.substr(1).replace(d,RegExp.$1+a+"="+c):window.location.search.match(/^\?/)?window.location.search=window.location.search+"&"+a+"="+escape(c):window.location.search="?"+a+"="+escape(c):geturlparam(a)?
        window.location.href=b+"?"+window.location.search.substr(1).replace(d,RegExp.$1+a+"="+c):window.location.search.match(/^\?/)?window.location.href=b+window.location.search+"&"+a+"="+escape(c):window.location.href=b+"?"+a+"="+escape(c)}});b.fn.extend({formErrorReset:function(){b(this).each(function(a,c){var d=b(this).hasClass("form-inline");b(this).find(".alert").remove();b(this).find(".form-group,.checkbox,.radio").each(function(c,a){d?(b(this).removeClass("has-error").find("input,textarea,select").each(function(){b(this).tooltip("destroy")}),
        b(this).tooltip("destroy")):b(this).hasClass("has-error")&&b(this).find(".help-block").data("orgtext")?b(this).removeClass("has-error").find(".help-block").html(b(this).find(".help-block").data("orgtext")):b(this).hasClass("has-error")&&b(this).removeClass("has-error").find(".help-block").remove()})});return b(this)},formFiledError:function(a){var c=b(this).parents(".form-group,.checkbox,.radio"),d="checkbox"==b(this).attr("type")||"radio"==b(this).attr("type"),e=b(this).parents("form").hasClass("form-inline");
        c.length?(c.addClass("has-error"),d&&!c.hasClass("checkbox")&&c.addClass("checkbox"),c.find(".help-block").length?(html=c.find(".help-block").html(),c.find(".help-block").data("orgtext",html).html(a)):e?window.setTimeout(function(){c.tooltip({container:"body",html:!0,placement:"top",title:a})},500):b(this).parent().append('<small class="help-block">'+a+"</small>")):b(this).parent("form").prepend('<div class="alert alert-danger"><button class="close" data-dismiss="alert"><i class="pci-cross pci-circle"></i></button>'+
            obj+"</div>")}});b("body").on("req.ajax",".ajax",function(a){var c=b(this);(a=c.attr("title"))||(a=c.text());a=b(this).attr("href");console.log("url"+a);if(c.data("ajaxing"))return b.niftyNoty({type:"danger",message:"\u7a0b\u5e8f\u5df2\u7ecf\u63d0\u4ea4\u4e2d\u4e86\uff0c\u8bf7\u7a0d\u540e\u7247\u523b\u3002",container:"floating",timer:5E3}),!1;c.data("ajaxing",!0);b.ajax({type:"GET",url:a,dataType:"json",data:{form:".ajax"}}).done(function(a){console.log(a);a.linkTextChange&&c.text(a.linkTextChange);
    a.linkTextChange&&c.text(a.linkTextChange);a.autoJump&&a.link&&0<a.link.length&&window.setTimeout(function(){window.location.href=a.link},1E3*a.autoJump);a.autoHide&&("string"===typeof a.autoHide&&c.parents(a.autoHide).length?c.parents(a.autoHide).hide(1E3,function(){b(this).remove()}):c.hide(1E3,function(){b(this).remove()}));a.message&&($dialogoption={},$dialogoption.message=a.message,$dialogoption.title="\u63d0\u793a\u4fe1\u606f",$dialogoption.buttons={},$dialogoption.buttons.ok=a.link&&0<a.link.length?
        {label:"\u786e\u5b9a",className:"btn-primary",callback:function(){window.location.href=a.link}}:{label:"\u786e\u5b9a",className:"btn-primary",callback:function(){}},b.dialog($dialogoption))}).fail(function(a,c){b.niftyNoty({type:"danger",message:c,container:"floating",timer:5E3})}).always(function(a){c.data("ajaxing",!1)})});b("body").on("click",".ajaxask,.ajax",function(a){a.preventDefault();var c=b(this);c.hasClass("ajax")||c.addClass("ajax");if(c.hasClass("ajaxask"))return a=c.data("asktext")?
    c.data("asktext"):"\u60a8\u786e\u5b9a\u8981"+c.text()+"?",$dialogoption={},$dialogoption.message=a,$dialogoption.title="\u63d0\u793a\u4fe1\u606f",$dialogoption.buttons={},$dialogoption.buttons.ok={label:"\u786e\u5b9a",className:"btn-primary",callback:function(){c.trigger("req.ajax")}},$dialogoption.buttons.cancel={label:"\u53d6\u6d88",className:"btn",callback:function(){}},b.dialog($dialogoption);b(this).trigger("req.ajax")});b("body").on("click",".ajaxdialog",function(a){a.preventDefault();var c=
    b(this);(a=c.attr("title"))||(a=c.text());c=c.attr("href");$dialogoption={};$dialogoption.url=c;$dialogoption.title=a;$dialogoption.buttons={};$dialogoption.buttons.ok={label:"\u63d0\u4ea4",className:"btn-primary",callback:function(a){a=b(".jquerydialog").find("form");a.length&&a.trigger("submit");return!1}};$dialogoption.buttons.cancel={label:"\u53d6\u6d88",className:"btn",callback:function(){}};return b.dialog($dialogoption)});b("body").on("submit","form.ajaxform",function(a){a.preventDefault();
    var c=b(this);if(c.data("submiting"))return b.niftyNoty({type:"danger",message:"\u7a0b\u5e8f\u5df2\u7ecf\u63d0\u4ea4\u4e2d\u4e86\uff0c\u8bf7\u7a0d\u540e\u7247\u523b\u3002",container:"floating",timer:5E3}),!1;c.data("submiting",1);a={};a.url=c.attr("action")?c.attr("action"):window.location.href;a.type=c.attr("method")?c.attr("method"):"GET";a.data=c.serializeArray();a.dataType="json";if("GET"==a.type.toUpperCase()){var d=b.param(a.data);a.url+=(0<=a.url.indexOf("?")?"&":"?")+d;a.data=null}c.formErrorReset();
    b.ajax(a).done(function(a,d){console.log(a);a.message&&($dialogoption={},$dialogoption.message=a.message,$dialogoption.title="\u63d0\u793a\u4fe1\u606f",$dialogoption.buttons={},$dialogoption.buttons.ok=a.link&&0<a.link.length?{label:"\u786e\u5b9a",className:"btn-primary",callback:function(){window.location.href=a.link}}:{label:"\u786e\u5b9a",className:"btn-primary",callback:function(){}},b.dialog($dialogoption));a.autoJump&&a.link&&0<a.link.length&&window.setTimeout(function(){window.location.href=
        escape2Html(a.link)},1E3*a.autoJump);a.error&&b.each(a.error,function(a,b){a=c.find("input[name='"+a+"'],textarea[name='"+a+"'],select[name='"+a+"']");var d=a.parents(".form-group,.checkbox,.radio");a.length&&d.length?a.formFiledError(b):c.prepend('<div class="alert alert-danger"><button class="close" data-dismiss="alert"><i class="pci-cross pci-circle"></i></button>'+b+"</div>")})}).fail(function(a,c){b.niftyNoty({type:"danger",message:"\u63d0\u4ea4\u6570\u636e\u51fa\u9519\uff0c\u53ef\u80fd\u662f\u670d\u52a1\u5668\u6b63\u5728\u7ef4\u62a4\u6216\u662f\u7f51\u7edc\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",
        container:"floating",timer:5E3})}).always(function(){c.data("submiting",0);console.log("complete")})})});
<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>General Elements | Nifty - Admin Template</title>


    <!--STYLESHEET-->
    <!--=================================================-->

    <!--Open Sans Font [ OPTIONAL ]-->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700' rel='stylesheet' type='text/css'>


    <!--Bootstrap Stylesheet [ REQUIRED ]-->
    <link href="css/bootstrap.min.css" rel="stylesheet">


    <!--Nifty Stylesheet [ REQUIRED ]-->
    <link href="css/nifty.min.css" rel="stylesheet">


    <!--Nifty Premium Icon [ DEMONSTRATION ]-->
    <link href="css/demo/nifty-demo-icons.min.css" rel="stylesheet">


    <!--=================================================-->



    <!--Pace - Page Load Progress Par [OPTIONAL]-->
    <link href="plugins/pace/pace.min.css" rel="stylesheet">
    <script src="plugins/pace/pace.min.js"></script>


    <!--Demo [ DEMONSTRATION ]-->
    <link href="css/demo/nifty-demo.min.css" rel="stylesheet">


            
    <!--=================================================

    REQUIRED
    You must include this in your project.


    RECOMMENDED
    This category must be included but you may modify which plugins or components which should be included in your project.


    OPTIONAL
    Optional plugins. You may choose whether to include it in your project or not.


    DEMONSTRATION
    This is to be removed, used for demonstration purposes only. This category must not be included in your project.


    SAMPLE
    Some script samples which explain how to initialize plugins or components. This category should not be included in your project.


    Detailed information and more samples can be found in the document.

    =================================================-->
        
</head>

<!--TIPS-->
<!--You may remove all ID or Class names which contain "demo-", they are only used for demonstration. -->
<body>
    <div id="container" class="effect mainnav-lg">
        
        <!--NAVBAR-->
        <!--===================================================-->
        <!--===================================================-->
        <!--END NAVBAR-->

        <div class="boxed">

            <!--CONTENT CONTAINER-->
            <!--===================================================-->
            <div id="content-container1">
                <!--Page content-->
                <!--===================================================-->
                <div id="page-content">
                    
					<div class="panel">
					    <div class="panel-heading">
					        <h3 class="panel-title">Inline Form</h3>
					    </div>
					    <div class="panel-body">
					
					        <!-- Inline Form  -->
					        <!--===================================================-->
					        <form class="form-inline ajaxform">
					            <div class="form-group">
					                <label for="demo-inline-inputmail" class="sr-only">Email address</label>
					                <input type="email" placeholder="Enter email" id="demo-inline-inputmail" class="form-control">
					            </div>
					            <div class="form-group">
					                <label for="demo-inline-inputpass" class="sr-only">Password</label>
					                <input type="password" placeholder="Password" id="demo-inline-inputpass" class="form-control">
					            </div>
					            <div class="checkbox">
					                <input id="demo-remember-me" class="magic-checkbox" type="checkbox">
					                <label for="demo-remember-me">Remember me</label>
					            </div>
					            <button class="btn btn-primary" type="submit">Sign in</button>
					        </form>
					        <!--===================================================-->
					        <!-- End Inline Form  -->
					
					    </div>
					</div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="panel">
                                <div class="panel-heading">
                                    <h3 class="panel-title">ajax</h3>
                                </div>
                                <div class="panel-body">
                                    <div><a href="/ajax.link.json" class="ajax">请求并转变文字</a>
                                        <a href="/ajax.link2.json" class="ajax">请求并转到其它页面</a>
                                        <a href="/ajax.link3.json" class="ajax">请求并自动转到其它页面</a>
                                        <a href="/ajax.link4.json" class="ajax">请求并隐藏自身元素</a>
                                        <a href="/ajax.link5.json" class="ajax">请求并隐藏上级元素</a>
                                        <a href="/ajax.link6.json" class="ajax">不提示消息</a></div>


                                    <div><a href="/ajax.link.json" class="ajax ajaxask">请求并转变文字带确认</a>
                                        <a href="/ajax.link2.json" class="ajax ajaxask">请求并转到其它页面带确认</a>
                                        <a href="/ajax.link3.json" class="ajax ajaxask">请求并自动转到其它页面带确认</a>
                                        <a href="/ajax.link4.json" class="ajax ajaxask">请求并隐藏自身元素带确认</a>
                                        <a href="/ajax.link5.json" class="ajax ajaxask">请求并隐藏上级元素带确认</a>
                                        <a href="/ajax.link6.json" class="ajaxask">不提示消息带提示带确认</a></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <div class="panel">
                                <div class="panel-heading">
                                    <h3 class="panel-title">表彰</h3>
                                </div>
                                <div class="panel-body">
                                    <div><a href="/ajax.dialog.html" class="ajaxdialog">表单</a>
                                </div>
                            </div>
                        </div>
                    </div>
					<div class="row">
					    <div class="col-sm-12">
					        <div class="panel">
					            <div class="panel-heading">
					                <h3 class="panel-title">Horizontal form</h3>
					            </div>
					
					            <!--Horizontal Form-->
					            <!--===================================================-->
					            <form class="form-horizontal ajaxform">
					                <div class="panel-body">
					                    <div class="form-group">
					                        <label class="col-sm-3 control-label" for="demo-hor-inputemail">Email</label>
					                        <div class="col-sm-9">
					                            <input type="email" placeholder="Email" id="demo-hor-inputemail" class="form-control">
					                        </div>
					                    </div>
					                    <div class="form-group">
					                        <label class="col-sm-3 control-label" for="demo-hor-inputpass">Password</label>
					                        <div class="col-sm-9">
					                            <input type="password" placeholder="Password" id="demo-hor-inputpass" class="form-control">
					                        </div>
					                    </div>
					                    <div class="form-group">
					                        <div class="col-sm-offset-3 col-sm-9">
					                            <input id="demo-remember-me-2" class="magic-checkbox" type="checkbox">
					                            <label for="demo-remember-me-2">Remember me</label>
					                        </div>
					                    </div>
					                </div>
					                <div class="panel-footer text-right">
					                    <button class="btn btn-success" type="submit">Sign in</button>
					                </div>
					            </form>
					            <!--===================================================-->
					            <!--End Horizontal Form-->
					
					        </div>
					    </div>
					</div>


                </div>
                <!--===================================================-->
                <!--End page content-->

            </div>
            <!--===================================================-->

        </div>



    </div>
    <!--===================================================-->
    <!-- END OF CONTAINER -->


    
    
    
    <!--JAVASCRIPT-->
    <!--=================================================-->

    <!--jQuery [ REQUIRED ]-->
    <script src="js/jquery.js"></script>


    <!--BootstrapJS [ RECOMMENDED ]-->
    <script src="js/bootstrap.js"></script>


    <!--NiftyJS [ RECOMMENDED ]-->
    <script src="js/nifty.min.js"></script>
    <script src="/plugins/jquery.form.js"></script>
    <script src="/plugins/jquery.dialog.min.js"></script>





    <!--=================================================-->
    
    <!--Demo script [ DEMONSTRATION ]-->
    <script src="js/demo/nifty-demo.min.js"></script>
    <script>
        $('body').on('req.ajax','.ajax',function(e){
            var linkobj=$(this);
            var title = linkobj.attr('title');
            if (!title) {
                title = linkobj.text();
            }
            var url = $(this).attr('href');
            console.log('url'+url);
            if(linkobj.data('ajaxing')){
                $.niftyNoty({
                    type: 'danger',
                    message : '程序已经提交中了，请稍后片刻。',
                    container : 'floating',
                    timer : 5000
                });
                return false;
            }
            linkobj.data('ajaxing',true);
            $.ajax({
                type : 'GET',
                url : url,
                dataType : 'json',
                'data':{form:'.ajax'}
                }
            ).done(function(data) {
                    console.log(data);
                    if(data.linkTextChange){
                        linkobj.text(data.linkTextChange)
                    }
                    if(data.linkTextChange){
                        linkobj.text(data.linkTextChange)
                    }
                    if(data.autoJump && data.link && data.link.length>0){
                        window.setTimeout(function() {
                            window.location.href = data.link;
                        }, data.autoJump*1000);
                    }
                    if(data.autoHide){
                        if(typeof data.autoHide ==='string' && linkobj.parents(data.autoHide).length){
                            linkobj.parents(data.autoHide).hide(1000,function (){$(this).remove();});
                        }else{
                            linkobj.hide(1000,function (){$(this).remove();});
                        }
                    }
                    if(data.message){
                        $dialogoption={};
                        $dialogoption.message=data.message;
                        $dialogoption.title='提示信息';
                        $dialogoption.buttons={};
                        if (data.link && data.link.length>0) {
                            $dialogoption.buttons.ok = {
                                label : '确定',
                                className: "btn-primary",
                                callback : function() {
                                    window.location.href = data.link;
                                }
                            } ;
                        } else {
                            $dialogoption.buttons.ok = {
                                label : '确定',
                                className: "btn-primary",
                                callback : function() {
                                }
                            } ;
                        }
                        $.dialog($dialogoption);
                    }
                }).fail(function (jqXHR, textStatus) {
                    $.niftyNoty({
                        type: 'danger',
                        message : textStatus,
                        container : 'floating',
                        timer : 5000
                    });
            }).always(function (xx){
                linkobj.data('ajaxing',false);
            });
        });
        $('body').on('click','.ajaxask,.ajax',function(e){
            e.preventDefault();
            var linkobj=$(this);
            if(!linkobj.hasClass("ajax")){
                linkobj.addClass("ajax");
            }
            if(linkobj.hasClass("ajaxask")){
                var asktext = linkobj.data('asktext') ? linkobj.data('asktext') : "您确定要" + linkobj.text()+ "?";
                $dialogoption={};
                $dialogoption.message=asktext;
                $dialogoption.title='提示信息';
                $dialogoption.buttons={};
                $dialogoption.buttons.ok = {
                    label : '确定',
                    className: "btn-primary",
                    callback : function() {
                        linkobj.trigger('req.ajax')
                    }
                } ;
                $dialogoption.buttons.cancel = {
                    label : '取消',
                    className: "btn",
                    callback : function() {
                    }
                } ;
                return $.dialog($dialogoption);
            };
            $(this).trigger('req.ajax');
        });
        $('body').on('click','.ajaxdialog',function(e){
            e.preventDefault();
            var linkobj=$(this);
            var title=linkobj.attr('title');
            if(!title){
                title=linkobj.text();
            }
            var url=linkobj.attr('href');
            $dialogoption={};
            $dialogoption.url=url;
            $dialogoption.title=title;
            $dialogoption.buttons={};
            $dialogoption.buttons.ok = {
                label : '提交',
                className: "btn-primary",
                callback : function(event){
                    var form=$('.jquerydialog').find('form');
                    if(form.length){
                        form.trigger('submit');
                    }
                    return false;
                }
            } ;
            $dialogoption.buttons.cancel = {
                label : '取消',
                className: "btn",
                callback : function() {
                }
            } ;
            return $.dialog($dialogoption);
        });

        $('body').on('submit','form.ajaxform',function(e){
            e.preventDefault();
            var jqueryfrom = $(this);
            console.log("jqueryfrom.data('submiting')",jqueryfrom.data('submiting'));
            if(jqueryfrom.data('submiting')){
                $.niftyNoty({
                    type: 'danger',
                    message : '程序已经提交中了，请稍后片刻。',
                    container : 'floating',
                    timer : 5000
                });
                return false;
            }

            jqueryfrom.data('submiting',1);
            jqueryfrom.ajaxSubmit({
                dataType : 'json',
                beforeSend : function(data) {
                    console.log("beforeSend:");
                    console.log(data);
                //         jqueryfrom.find('.control-group').each(
                //             function(index,item) {
                //                 if ($(this).hasClass('error')&& $(this).find('span.help-inline,span.help-block').data('orgtext')) {
                //                     $(this).removeClass('error').find('span.help-inline,span.help-block').html($(this).find('span.help-inline,span.help-block').data('orgtext'));
                //                 } else if($(this).hasClass('error')) {
                //                     $(this).removeClass('error').find('span.help-inline,span.help-block').remove();
                //                 }
                //             });
                //         jqueryfrom.find('.alert-block').remove();
                //         cploading();
                },
                complete:function (){
                    jqueryfrom.data('submiting',0);
                    console.log("complete");
                },
                beforeSubmit : function(arr, form,options) {
                    if ($.isFunction(beforeSubmit)) {
                        var res = beforeSubmit(arr, form,options);
                        console.log(res);
                        if(res == false){
                            jqueryfrom.data('submiting',0);
                        }
                        return res;
                    }
                    return true;
                },
                //     success : function(data, statusText) {
                //         console.log("success");
                //         cploadingdestroy();
                //         if (data.msg) {
                //             if (data.state == 1) {
                //                 if (data.url) {
                //                     buttons = [ {
                //                         'text' : '确定',
                //                         'click' : function() {
                //                             cpdialogdestroy();
                //                             window.location.href = escape2Html(data.url);
                //                         }
                //                     } ];
                //                 } else {
                //                     buttons = [ {
                //                         'text' : '确定',
                //                         'click' : function() {
                //                             cpdialogdestroy();
                //                         }
                //                     } ];
                //                 }
                //                 cpdialog("提示信息",data.msg,buttons);
                //             } else if (data.state == 2) {
                //                 buttons = [];
                //                 cpdialog("",data.msg,buttons,false,2);
                //                 if (data.url) {
                //                     window.setTimeout(function() {
                //                         window.location.href = data.url;
                //                     }, 2000);
                //                 }
                //             } else {
                //                 if (data.field) {
                //                     if (jqueryfrom.find('input[name=\''+ data.field+ '\']').parents('.control-group').size()
                //                         || jqueryfrom.find('textarea[name=\''+ data.field+ '\']').parents('.control-group').size()
                //                         || jqueryfrom.find('select[name=\''+ data.field+ '\']').parents('.control-group').size()) {
                //                         obj = jqueryfrom.find('input[name=\''+ data.field+ '\'],textarea[name=\''+ data.field+ '\'],select[name=\''+ data.field+ '\']').parents('.control-group');
                //                         obj.addClass('error');
                //                         if (obj.find('.help-inline,.help-block').size()) {
                //                             html = obj.find('.help-inline,.help-block').html();
                //                             obj.find('.help-inline,.help-block').data('orgtext',html).html(data.msg);
                //                         } else {
                //                             obj.find('.controls').append('<span class=\"help-inline\">'+ data.msg+ '</span>');
                //                         }
                //                     } else {
                //                         jqueryfrom.prepend('<div class=\"alert alert-block alert-error\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>'+ data.msg+ '</div>');
                //                     }
                //                 }else{
                //                     jqueryfrom.prepend('<div class=\"alert alert-block alert-error\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>'+ data.msg+ '</div>');
                //                 }
                //                 if (data.url) {
                //                     window.setTimeout(function() {
                //                         window.location.href = data.url;
                //                     }, 2000);
                //                 }
                //             }
                //         }
                //         if ($.isFunction(afterSucess)) {
                //             afterSucess(data, statusText);
                //         }
                //         jqueryfrom.data('submiting',0);
                //     }
                });

        });
        function fixajaxdialog(){
            $('.ajaxdialog-callback').bind('click',function (){
                title=$(this).attr('title');
                if(!title){
                    title=$(this).text();
                }
                var args = $(this).attr('args');
                cpdialog(title,$(this).attr('href'),
                    [ {
                        'text' : "取消",
                        'click' : 'close'
                    }, {
                        'text' : "确定",
                        'main' : true,
                        'click' : function() {
                            if ($('form.dialog').size()) {
                                $.ajax({
                                    cache: true,
                                    type: "POST",
                                    url:$('form.dialog').attr("action"),
                                    data:$('form.dialog').serialize(),// 你的formid
                                    async: false,
                                    error: function(request) {
                                        alert("Connection error");
                                    },
                                    success: function(data) {
                                        if(typeof dialogcallback == "function"){
                                            dialogcallback(args);
                                        }
                                        cpdialogdestroy();
                                    }
                                });
                            } else {
                                cpdialogdestroy();
                            }
                        }
                    }
                    ], true, 0);
                return false;
            });
        }
        function htmlload(htmlobj, url, func, postdata) {

        }
        function cpdialog(title, html, buttons, isurl, autodestorytime) {

        }
        function cploading() {
        }
        function cploadingdestroy() {
        }
        function cpdialogdestroy() {
        }
        //转意符换成普通字符
        function escape2Html(str) {
            var arrEntities={'lt':'<','gt':'>','nbsp':' ','amp':'&','quot':'"'};
            return str.replace(/&(lt|gt|nbsp|amp|quot);/ig,function(all,t){return arrEntities[t];});
        }
        function ajaxform(jqueryfrom, beforeSubmit,afterSucess) {
            jqueryfrom.submit(function() {
                var jqueryfrom = $(this);
                console.log("jqueryfrom.data('submiting')",jqueryfrom.data('submiting'));
                if(jqueryfrom.data('submiting')){
                    zbjkit.tips('程序已经提交中了，请稍后片刻。', 'success');
                    return false;
                }
                jqueryfrom.data('submiting',1);
                $(this).ajaxSubmit({
                    dataType : 'json',
                    beforeSend : function(data) {
                        jqueryfrom.find('.control-group').each(
                            function(index,item) {
                                if ($(this).hasClass('error')&& $(this).find('span.help-inline,span.help-block').data('orgtext')) {
                                    $(this).removeClass('error').find('span.help-inline,span.help-block').html($(this).find('span.help-inline,span.help-block').data('orgtext'));
                                } else if($(this).hasClass('error')) {
                                    $(this).removeClass('error').find('span.help-inline,span.help-block').remove();
                                }
                            });
                        jqueryfrom.find('.alert-block').remove();
                        cploading();
                    },
                    complete:function (){
                        console.log("complete");
                    },
                    beforeSubmit : function(arr, form,options) {
                        if ($.isFunction(beforeSubmit)) {
                            var res = beforeSubmit(arr, form,options);
                            console.log(res);
                            if(res == false){
                                jqueryfrom.data('submiting',0);
                            }
                            return res;
                        }
                        return true;
                    },
                    success : function(data, statusText) {
                        console.log("success");
                        cploadingdestroy();
                        if (data.msg) {
                            if (data.state == 1) {
                                if (data.url) {
                                    buttons = [ {
                                        'text' : '确定',
                                        'click' : function() {
                                            cpdialogdestroy();
                                            window.location.href = escape2Html(data.url);
                                        }
                                    } ];
                                } else {
                                    buttons = [ {
                                        'text' : '确定',
                                        'click' : function() {
                                            cpdialogdestroy();
                                        }
                                    } ];
                                }
                                cpdialog("提示信息",data.msg,buttons);
                            } else if (data.state == 2) {
                                buttons = [];
                                cpdialog("",data.msg,buttons,false,2);
                                if (data.url) {
                                    window.setTimeout(function() {
                                        window.location.href = data.url;
                                    }, 2000);
                                }
                            } else {
                                if (data.field) {
                                    if (jqueryfrom.find('input[name=\''+ data.field+ '\']').parents('.control-group').size()
                                        || jqueryfrom.find('textarea[name=\''+ data.field+ '\']').parents('.control-group').size()
                                        || jqueryfrom.find('select[name=\''+ data.field+ '\']').parents('.control-group').size()) {
                                        obj = jqueryfrom.find('input[name=\''+ data.field+ '\'],textarea[name=\''+ data.field+ '\'],select[name=\''+ data.field+ '\']').parents('.control-group');
                                        obj.addClass('error');
                                        if (obj.find('.help-inline,.help-block').size()) {
                                            html = obj.find('.help-inline,.help-block').html();
                                            obj.find('.help-inline,.help-block').data('orgtext',html).html(data.msg);
                                        } else {
                                            obj.find('.controls').append('<span class=\"help-inline\">'+ data.msg+ '</span>');
                                        }
                                    } else {
                                        jqueryfrom.prepend('<div class=\"alert alert-block alert-error\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>'+ data.msg+ '</div>');
                                    }
                                }else{
                                    jqueryfrom.prepend('<div class=\"alert alert-block alert-error\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>'+ data.msg+ '</div>');
                                }
                                if (data.url) {
                                    window.setTimeout(function() {
                                        window.location.href = data.url;
                                    }, 2000);
                                }
                            }
                        }
                        if ($.isFunction(afterSucess)) {
                            afterSucess(data, statusText);
                        }
                        jqueryfrom.data('submiting',0);
                    }
                });
                return false;
            });
        }
        function geturlparam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]); return null;
        }
        function replaceurlparam(name,value, pathname) {
            if(pathname == undefined) {
                var reg = new RegExp("(^|&)" + name + "=[^&]*", "i");
                if(geturlparam(name)){
                    window.location.search='?'+window.location.search.substr(1).replace(reg,RegExp.$1+name+'='+value);
                }else{
                    if(window.location.search.match(/^\?/)){
                        window.location.search=window.location.search+'&'+name+'='+escape(value);
                    }else{
                        window.location.search='?'+name+'='+escape(value);
                    }
                }
            }else{
                var reg = new RegExp("(^|&)" + name + "=[^&]*", "i");

                if(geturlparam(name)){
                    window.location.href = pathname + '?'+window.location.search.substr(1).replace(reg,RegExp.$1+name+'='+value);
                }else{
                    if(window.location.search.match(/^\?/)){
                        window.location.href = pathname +window.location.search+'&'+name+'='+escape(value);
                    }else{
                        window.location.href = pathname + '?'+name+'='+escape(value);
                    }
                }
            }

        }
        /*--------------------获取Get----------------------*/
        function getArgs(){
            var args = {};
            var match = null;
            var search = decodeURIComponent(location.search.substring(1));
            var reg = /(?:([^&]+)=([^&]+))/g;
            while((match = reg.exec(search))!==null){
                args[match[1]] = match[2];
            }
            return args;
        }
    </script>
    
    

</body>
</html>
